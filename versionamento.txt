01 INICIO_PROJETO("Loja Online - Checkout")
02 usuario      <- obterUsuarioAutenticado()
03 carrinho     <- validarEntradas(usuario)
04 verificarCarrinho <- validar(carrinho validado com sucesso)
05 cepEntrega   <- obterEnderecoPadrao(usuario)
06 subtotal     <- calcularSubtotal(carrinho)            // B pode corrigir arred.
07 descontos    <- aplicarDescontos(cupom, usuario, subtotal) // cupom pode ser nulo
08 frete        <- calcularFrete(cepEntrega, carrinho)
09 total        <- max(0, subtotal + frete - descontos)
13 pagamento    <- criarTransacao(cartao, total)
14 SE pagamento.status == "APROVADO" ENTAO
15     reservaEstoque(carrinho.itens)
16    Um pedido gerado com todos os detalhes(cepEntrega)
17 SE (pagamento.aprovado) ENTAO     
18       enviarEmailConfirmacao(usuario.email, pedido.id)
19       quando o pagamento for comfimador ENTAO
20     limparCarrinho(usuario)
21     RETORNAR SUCESSO(pedido.id)

23 SENAO RETORNAR ERRO("Pagamento recusado")











